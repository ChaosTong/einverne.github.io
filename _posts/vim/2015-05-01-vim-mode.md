---
layout: post
title: "Vim 模式"
description: "VIM 模式，vim 具有 6 种基本模式和 5 种派生模式"
category: Vim
tags: [vim, linux, ]
last_updated: 2017-09-07
---

Vim 是一种多模式的编辑器，不同于一般的编辑器，进入便是编辑模式，可以在编辑模式下对文本进行各种编辑，Vim 进入之后是在普通模式 (Normal mode) 下。

## 基本模式

### 普通模式 Normal mode

在普通模式中，用户可以执行一般的编辑器命令，比如移动光标，删除文本等等。这也是 Vim 启动后的默认模式。这正好和许多新用户期待的操作方式相反 （大多数编辑器默认模式为插入模式）。

Vim 强大的编辑能力中很大部分是来自于其普通模式命令。普通模式命令往往需要一个操作符结尾。例如普通模式命令”dd”删除当前行，但是第一 个”d”的后面可以跟另外的移动命令来代替第二个”d”，比如用移动到下一行的”j”键就可以删除当前行和下一行。另外还可以指定命令重复次 数，”2dd”（重复”dd”两次），和”dj”的效果是一样的。用户学习了各种各样的文本间移动／跳转的命令和其他的普通模式的编辑命令，并且能够灵活 组合使用的话，能够比那些没有模式的编辑器更加高效的进行文本编辑。

在普通模式中，有很多方法可以进入插入模式。比较普通的方式是按”a”（append／追加，光标移动到行尾并进入插入模式）键或者直接使用”i”（insert／插入）键进入。

### 插入模式 Insert mode

在普通模式下按下 "i" 键进入，在这个模式中，大多数按键都会向文本缓冲中插入文本。这是大多数文本编辑器的默认模式，也是大多数新用户希望文本编辑器编辑过程中保持的模式。但是 Vim 的设计哲学告诉我们，只有在真正输入文本的时候进入该模式，否则立即按下 ESC 退出到普通模式。

在插入模式中，可以按 ESC 键回到普通模式。

### 可视模式 Visual mode

在普通模式下按下 "v" 键进入，使用“V”可按行选择， 这个模式与普通模式比较相似。但是移动命令会扩大高亮的文本区域。高亮区域可以是字符、行或者是一块文本。当执行一个非移动命令时，命令会被执行到 这块高亮的区域上。Vim 的”文本对象”也能和移动命令一样用在这个模式中。

- 用<kbd>v</kbd>命令进入的字符可视化模式（Characterwise visual mode)。文本选择是以字符为单位的。
- 用<kbd>V</kbd>命令进入的行可视化模式（Linewise visual mode)。文本选择是以行为单位的。
- 用<kbd>Ctrl-V</kbd>进入的块可视化模式（Blockwise visual mode）。可以选择一个矩形内的文本。（注意：在 Windows 中，<kbd>Ctrl-V</kbd>可能已经被影射为粘贴操作，可以使用<kbd>Ctrl-Q</kbd>进入块可视化模式。）

在 Vim 中使用如下命令查看更多官方帮助

	:h 04.4

### 选择模式 Select mode

这个模式和无模式编辑器的行为比较相似（Windows 标准文本控件的方式）。选择模式与可视模式相似，这个模式中，可以用鼠标或者光标键高亮选择文本，不过输入任何字符的，Vim 会用这个字符替换选择的高亮文本块，并且自动进入插入模式。选择模式更多在 MS-Windows 中用到，其他系统如需启动选择模式，首先需要激活：

	:set selectmode+=mouse

在 Vim 中使用如下命令查看更多官方帮助

	:h 09.4

### 命令行模式
因为历史原因，在命令行模式中执行的命令又被称为 Ex 命令。

在命令行模式中可以输入会被解释成并执行的文本。例如执行命令（`:`键），搜索（`/`和`?`键）或者过滤命令（`!`键）。在命令执行之 后，Vim 返回到命令行模式之前的模式，通常是普通模式。

- 读写文件 `:edit`， `:write`
- 创建新标签页 `:tabnew`
- 分割窗口 `:split`
- 操作参数列表 `:prev/:next`
- 缓冲区列表 `:bprev/:bnext`
- 替换，比如使用 `:%s/a/b/g` 将文本中所有的 a 替换成 b。
- 搜索 `/abc` 来搜索文本中的 abc 字符串

Vim 为几乎所有功能功能都提供了 Ex 命令，参考 `:h ex-cmd-index`

### Ex 模式

这和命令行模式比较相似，在使用”:visual”命令离开 Ex 模式前，可以一次执行多条命令。我至今没用过，也不知道怎么弄，如果需要 Google 关键词：Vim Ex 模式。

普通模式下按 Q 进入 Ex 模式，多行 Command Line 模式

## 派生模式

### 操作符等待模式

这个派生模式指普通模式中，执行一个操作命令后 Vim 等待一个”动作”来完成这个命令。Vim 也支持在操作符等待模式中使用”文本对象”作为动作， 包括”aw”一个单词（a word）、”as”一个句子（a sentence）、”ap”一个段落（a paragraph）等等。

比如，在普通模式下”d2as”删除当前和下一个句子。在可视模式下”apU”把当前段落所有字母大写。

### 插入普通模式

这个模式是在插入模式下按下 ctrl-o 键的时候进入。这个时候暂时进入普通模式，执行完一个命令之后，Vim 返回插入模式

### 插入可视模式

这个模式是在插入模式下按下 ctrl-o 键并且开始一个可视选择的时候开始。在可视区域选择取消的时候，Vim 返回插入模式。

### 插入选择模式

通常这个模式由插入模式下鼠标拖拽或者 shift 方向键来进入。当选择区域取消的时候，Vim 返回插入模式。

### 替换模式

这是一个特殊的插入模式，在这个模式中可以做和插入模式一样的操作，但是每个输入的字符都会覆盖文本缓冲中已经存在的字符。在普通模式下按”R”键进入。

![vim key command](https://lh6.googleusercontent.com/-777zNXGtePg/VUSf2KO3eoI/AAAAAAAAnjM/zrkNBCUya0o/s0/gVim_commond_tree.png)
